<!--pages/message/list/list.wxml-->
<view class="container">
  <!-- Tabåˆ‡æ¢ -->
  <view class="tab-container">
    <view class="tab-item {{currentTab === 'order' ? 'active' : ''}}" bindtap="switchTab" data-tab="order">
      <text>è®¢å•é€šçŸ¥</text>
      <view wx:if="{{unreadCount.order > 0}}" class="badge">{{unreadCount.order}}</view>
    </view>
    <view class="tab-item {{currentTab === 'system' ? 'active' : ''}}" bindtap="switchTab" data-tab="system">
      <text>ç³»ç»Ÿé€šçŸ¥</text>
      <view wx:if="{{unreadCount.system > 0}}" class="badge">{{unreadCount.system}}</view>
    </view>
  </view>

  <!-- æ¶ˆæ¯åˆ—è¡¨ -->
  <view wx:if="{{!loading && messages.length > 0}}" class="message-list">
    <view wx:for="{{messages}}" wx:key="id" class="message-item" bindtap="viewMessageDetail" data-id="{{item.id}}">
      <view class="message-icon">
        <view class="icon {{currentTab === 'order' ? 'order-icon' : 'system-icon'}}"></view>
      </view>
      <view class="message-content">
        <view class="message-header">
          <view class="message-title">{{item.title}}</view>
          <view wx:if="{{!item.is_read}}" class="new-badge">æ–°</view>
        </view>
        <view class="message-desc">{{item.content}}</view>
        <view class="message-time">{{formatTime(item.created_at)}}</view>
      </view>
      <view class="message-arrow">
        <text class="iconfont icon-arrow-right"></text>
      </view>
    </view>
  </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{!loading && messages.length === 0}}">
      <text class="empty-icon">ğŸ’¬</text>
      <text class="empty-text">æš‚æ— æ¶ˆæ¯</text>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-state" wx:if="{{loading}}">
      <text>åŠ è½½ä¸­...</text>
    </view>

    <!-- æ²¡æœ‰æ›´å¤š -->
    <view class="no-more" wx:if="{{!hasMore && messages.length > 0}}">
      <text>æ²¡æœ‰æ›´å¤šæ¶ˆæ¯äº†</text>
    </view>
  </view>
