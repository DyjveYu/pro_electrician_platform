<!--pages/index/index.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨ä½ç½®æ  - å›ºå®šåœ¨é¡µé¢æœ€é¡¶éƒ¨æœ€å·¦ä¾§ 2025.11.3
  <view class="location-bar" bindtap="onLocationTap">
    <view class="location-content">
      <text class="location-icon">ğŸ“</text>
      <text class="location-text">{{locationText}}</text>
    </view>
    <text class="location-arrow"></text>
  </view>-->

  <!-- ç”¨æˆ·è§’è‰²ç•Œé¢ -->
  <view wx:if="{{currentRole === 'user'}}" class="user-content">
    <!-- ä¸»è¦æœåŠ¡å¡ç‰‡ -->
    <view class="service-card" bindtap="createOrder">
      <view class="service-icon">âš¡</view>
      <view class="service-info">
        <text class="service-title">ç«‹å³ä¸‹å•</text>
        <text class="service-desc">ä¸“ä¸šç”µå·¥ä¸Šé—¨æœåŠ¡</text>
      </view>
      <view class="service-arrow">></view>
    </view>

    <!-- æœ€è¿‘è®¢å• -->
    <view class="section">
      <view class="section-header">
        <text class="section-title">å·²å®Œæˆè®¢å•</text>
        <text class="section-more" bindtap="viewAllOrders">æŸ¥çœ‹å…¨éƒ¨</text>
      </view>
      
      <view wx:if="{{loading}}" class="loading">
        <text>åŠ è½½ä¸­...</text>
      </view>
      
      <view wx:elif="{{recentOrders.length > 0}}" class="order-list">
        <view wx:for="{{recentOrders}}" wx:key="id" class="order-item">
          <view class="order-header">
            <text class="order-title">{{item.title}}</text>
            <text class="order-status status-{{item.status}}">{{item.statusText}}</text>
          </view>
          <view class="order-info">
            <text class="order-electrician">ç”µå·¥ï¼š{{item.electrician_name}}</text>
            <text class="order-time">{{item.createdTime}}</text>
          </view>
          <view wx:if="{{item.rating}}" class="order-rating">
            <text class="rating-text">è¯„åˆ†ï¼š{{item.rating}}åˆ†</text>
            <text class="price-text">ï¿¥{{item.final_price}}</text>
          </view>
        </view>
      </view>
      
      <view wx:else class="empty-state">
        <text class="empty-text">æš‚æ— è®¢å•è®°å½•</text>
        <text class="empty-desc">ç‚¹å‡»ä¸Šæ–¹"ç«‹å³ä¸‹å•"åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªè®¢å•</text>
      </view>
    </view>
  </view>

  <!-- ç”µå·¥è§’è‰²ç•Œé¢ -->
  <view wx:elif="{{currentRole === 'electrician'}}" class="electrician-content">
    <!-- ç”µå·¥å·¥ä½œå° -->
    <view class="electrician-dashboard">
      <view class="dashboard-item" bindtap="viewAllOrders">
        <text class="dashboard-icon">ğŸ“‹</text>
        <text class="dashboard-title">æˆ‘çš„è®¢å•</text>
      </view>
      <view class="dashboard-item" bindtap="refreshOrders">
        <text class="dashboard-icon">ğŸ”„</text>
        <text class="dashboard-title">åˆ·æ–°è®¢å•</text>
      </view>
    </view>

    <!-- é™„è¿‘è®¢å• -->
    <view class="section">
      <view class="section-header">
        <text class="section-title">é™„è¿‘è®¢å•</text>
        <text class="section-subtitle">å¯æ¥å•çš„è®¢å•</text>
      </view>
      
      <view wx:if="{{loading}}" class="loading">
        <text>åŠ è½½ä¸­...</text>
      </view>
      
      <view wx:elif="{{nearbyOrders.length > 0}}" class="nearby-order-list">
        <view wx:for="{{nearbyOrders}}" wx:key="id" class="nearby-order-item">
          <view class="order-card">
            <view class="order-header">
              <text class="order-title">{{item.title}}</text>
              <text class="order-status status-{{item.status}}">{{item.statusText}}</text>
            </view>
            
            <view class="order-details">
              <view class="detail-row">
                <text class="detail-label">æœåŠ¡ç±»å‹ï¼š</text>
                <text class="detail-value">{{item.service_type || 'ç”µå·¥æœåŠ¡'}}</text>
              </view>
              <view class="detail-row">
                <text class="detail-label">å‘å¸ƒæ—¶é—´ï¼š</text>
                <text class="detail-value">{{item.createdTime}}</text>
              </view>
              <view wx:if="{{item.distance}}" class="detail-row">
                <text class="detail-label">è·ç¦»ï¼š</text>
                <text class="detail-value">{{item.distance}}</text>
              </view>
              <view wx:if="{{item.expected_price}}" class="detail-row">
                <text class="detail-label">é¢„æœŸä»·æ ¼ï¼š</text>
                <text class="detail-value price">ï¿¥{{item.expected_price}}</text>
              </view>
            </view>
            
            <view wx:if="{{item.description}}" class="order-description">
              <text class="description-text">{{item.description}}</text>
            </view>
            
            <view class="order-actions">
              <button class="detail-btn" bindtap="viewOrderDetail" data-id="{{item.id}}">æŸ¥çœ‹è¯¦æƒ…</button>
              <button class="take-order-btn" bindtap="takeOrder" data-id="{{item.id}}">æ¥å•</button>
            </view>
          </view>
        </view>
      </view>
      
      <view wx:else class="empty-state">
        <text class="empty-text">æš‚æ— é™„è¿‘è®¢å•</text>
        <text class="empty-desc">è¯·ç¨ååˆ·æ–°æˆ–æ‰©å¤§æœç´¢èŒƒå›´</text>
      </view>
    </view>
  </view>
</view>

<!-- å·²ç§»é™¤æŠ¥ä»·å¼¹çª—ï¼šæ¥å•æ”¹ä¸ºç›´æ¥è°ƒç”¨æ¥å£ -->